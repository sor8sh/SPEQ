# SPEQ: quality assessment of peptide tandem mass spectra with deep learning
This repository contains the source code for **SPEQ**, a tool for assessing the quality of peptide tandem mass spectra using deep learning.
This work has been published in the _Bioinformatics_ journal: [https://doi.org/10.1093/bioinformatics/btab874](https://doi.org/10.1093/bioinformatics/btab874)


## Dependencies
The following dependencies are needed in order to use this tool:
- [TensorFlow](https://www.tensorflow.org/install)
- [Pytemoics](https://pypi.org/project/pyteomics/)
- [NumPy](https://numpy.org/install/)
- [Matplotlib](https://matplotlib.org/stable/users/installing/index.html)
- [Pandas](https://pandas.pydata.org/docs/getting_started/install.html)
- [Scikit-learn](https://scikit-learn.org/stable/install.html)


## Usage
To run the program, execute the SPEQ.py script using Python 3:
``` bash
python3 SPEQ.py
```

## Data format
#### Input data:
* The MS input data should be in **MGF format**. 
* The data file is then automatically generated by the program.

#### Labels:
* A database search result in `.tsv` format (MS-GF+ output) is used to generate the labels.
* The decoy prefix (used in the database-searching) must be defined in the `config.yml` file. The program uses **1% FDR threshold**.
* Alternatively, you can provide your own `labels.csv` file.
  It must have two columns:
  * `Title`: Corresponds to the spectrum title in the MGF file
  * `Label`: **0** (low quality) or **1** (high quality)
